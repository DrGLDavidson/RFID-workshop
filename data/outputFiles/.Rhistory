setwd("F:/RWorkspace/GitHub/RFID-workshop/data")
PIT<-read.csv(file="PITList_tutorial.csv", header=TRUE)
setwd("F:/RWorkspace/GitHub/RFID-workshop/data/feederData")
PIT<-read.csv(file="PITList_tutorial.csv", header=TRUE)
names(PIT)
PIT<-read.csv(file="PITList_tutorial.csv", header=TRUE)
names(PIT)
PIT[duplicated(PIT$pitID),]
PIT<-read.csv(file="PITList_tutorial.csv", header=TRUE)
names(PIT)
PIT[duplicated(PIT$pitID),]
names(PIT)
length(unique(PIT$pitID))
PIT<-read.csv(file="PITList_tutorial.csv", header=TRUE)
names(PIT)
length(unique(PIT$pitID))
head(PIT)
head(PIT)
head(df)
path2<-"F:/RWorkspace/GitHub/RFID-workshop/data/feederData/F01_220206"
list.files(path2, pattern=NULL, all.files=FALSE,
full.names=FALSE, recursive = TRUE)
setwd(path2)
df1<-read.delim("C1935RT.txt", header=TRUE)
df1<-cbind(df1, feeder='F01')
path3<-"F:/RWorkspace/GitHub/RFID-workshop/data/feederData/F02_220206"
setwd(path3)
list.files(path3, pattern=NULL, all.files=FALSE,
full.names=FALSE, recursive = TRUE)
df2<-read.delim("C1931RT.txt", header=TRUE)
df2<-cbind(df2, feeder='F02')
path4<-"F:/RWorkspace/GitHub/RFID-workshop/data/feederData/F03_220206"
setwd(path4)
RTfile<-list.files(path4, pattern = "RT")
df3<-lapply(RTfile, read.delim) #this will appear as a list in your environment
df3<-as.data.frame(df3) #turn it into a dataframe
head(df3)
df3<-cbind(df3, feeder='F03')
d220206<-bind_rows(df1,df2,df3)
library(dplyr)
d220206<-bind_rows(df1,df2,df3)
path2<-"F:/RWorkspace/GitHub/RFID-workshop/data/feederData/F01_220209"
setwd(path2)
rm(df1)
rm(df2)
rm(df3)
path2<-"F:/RWorkspace/GitHub/RFID-workshop/data/feederData/F01_220209"
RTfile<-list.files(path2, pattern = "RT")
df1<-lapply(RTfile, read.delim) #this will appear as a list in your environment
df1<-as.data.frame(df1) #turn it into a dataframe
head(df1)
df1<-cbind(df1, feeder='F01')
RTfile<-list.files(path3, pattern = "RT")
df2<-lapply(RTfile, read.delim) #this will appear as a list in your environment
path3<-"F:/RWorkspace/GitHub/RFID-workshop/data/feederData/F02_220209"
RTfile<-list.files(path3, pattern = "RT")
df2<-lapply(RTfile, read.delim) #this will appear as a list in your environment
setwd(path3)
RTfile<-list.files(path3, pattern = "RT")
df2<-lapply(RTfile, read.delim) #this will appear as a list in your environment
df2<-as.data.frame(df2) #turn it into a dataframe
head(df2)
df2<-cbind(df2, feeder='F02')
path4<-"F:/RWorkspace/GitHub/RFID-workshop/data/feederData/F03_220209"
setwd(path4)
# Call the RT file into your environment and call it df2 (dataframe 3)
RTfile<-list.files(path4, pattern = "RT")
df3<-lapply(RTfile, read.delim) #this will appear as a list in your environment
df3<-as.data.frame(df3) #turn it into a dataframe
head(df3)
df3<-cbind(df3, feeder='F03')
d220209<-bind_rows(df1,df2,df3)
dfinal<-bind_rows(d220206,d220209)  #the order of the dfs as arguments will determine the order in which they appear in the dataframe. You can change this, but you could here choose the most contemporary date to come second.
setwd("F:/RWorkspace/GitHub/RFID-workshop/data/outputFiles")
write.table(dfinal, file = "Masterdf_220209.txt",sep="\t",row.names=FALSE)
df<-read.delim("Masterdf_220209.txt", header=TRUE)
rm(df1)
rm(df2)
rm(df3)
rm(d220206, d220209)
View(df)
rm(dfinal)
head(PIT)
names(PIT)[names(PIT) == "pitID"] <- "TagID_hex"
names(PIT)
df1 <- merge(df, PIT, by = "TagID_hex", all = TRUE)
df1[is.na(df1)] <- "NA"
View(df1)
missing<-df1%>%
filter(btoID=="NA")
#There are 26 variables in this dataframe. Lets view it.
view(missing)
view(missing)
View(missing)
View(df)
dftest <- with(df, df[!(TagID_hex == "" | is.na(TagID_hex)), ])
View(dftest)
df <- with(df, df[!(TagID_hex == "" | is.na(TagID_hex)), ])
rm(dftest)
df1 <- merge(df, PIT, by = "TagID_hex", all = TRUE)
df1[is.na(df1)] <- "NA"
missing<-df1%>%
filter(btoID=="NA")
View(missing)
uniqueMisreads <- unique(missing$TagID_hex)
uniqueMisreads
df2<-df1[!is.na(df1$btoRing),]
View(df1)
df2 <- merge(df, PIT, by = "TagID_hex", all = FALSE)
df1 <- merge(df, PIT, by = "TagID_hex", all = FALSE)
1268-1214
df2<-left_join(df, PIT ,by ="TagID_hex")
df2<-df2[!is.na(df2$btoRing),]
getwd()
write.table(df2, file = "Masterdf_noMisreads.txt",sep="\t",row.names=FALSE)
df2<-df2%>%
mutate(Date=ymd_hms(Date))
library(tidyverse)
library(rmarkdown)
library(dplyr)
library(tidyr)
library(lubridate)
df2<-df2%>%
mutate(Date=ymd_hms(Date))
class(df2$Date)
names(df2)
df3<-df2 %>%
arrange(Date)%>%
group_by(feeder, TagID_hex) %>%
mutate(timeSincePreviousVisit = Date - lag(Date))%>%
arrange(RFID, feeder, Date)%>%
ungroup()%>%
select(feeder, TagID_hex,Date, timeSincePreviousVisit)
df3<-df2 %>%
arrange(Date)%>%
group_by(feeder, TagID_hex) %>%
mutate(timeSincePreviousVisit = Date - lag(Date))%>%
arrange(TagID_hex, feeder, Date)%>%
ungroup()%>%
select(feeder, TagID_hex,Date, timeSincePreviousVisit)
View(df3)
df3<-df2 %>%
arrange(Date)%>%
group_by(feeder, TagID_hex) %>%
mutate(timeSincePreviousVisit = Date - lag(Date))%>%
arrange(TagID_hex, feeder, Date)%>%
ungroup()
View(df3)
View(df2)
View(df2)
View(df3)
df3$timeSincePreviousVisit <- gsub(' secs', '', df3$timeSincePreviousVisit)
View(df3)
df3$timeSincePreviousVisit <- as.numeric(as.character(df3$timeSincePreviousVisit))
class(df3$timeSincePreviousVisit)
df4<-df3%>%
filter(timeSincePreviousVisit <=20)%>%
select(timeSincePreviousVisit)
class(df4$timeSincePreviousVisit)
library(ggplot2)
ggplot(df4, aes(timeSincePreviousVisit, y= 1-..y..))+
stat_ecdf(geom = "step", color="purple")
ggplot(df4, aes(x=timeSincePreviousVisit)) +geom_histogram(binwidth = 1)
#note that there are NAs because it was the first visit of the dataframe so we can replace that with 'firstVisit'
df3$timeSincePreviousVisit[is.na(df3$timeSincePreviousVisit)] <- 'firstVisit'
df5<-df3%>%
filter(timeSincePreviousVisit=='firstVisit')
df6<-df3%>%
filter(timeSincePreviousVisit>2)
df6<-df3%>%
filter(timeSincePreviousVisit>3)
df6$timeSincePreviousVisit <- as.character(df6$timeSincePreviousVisit)
df7<-bind_rows(df5,df6)%>%
arrange(RFID,feeder,date)
df7<-bind_rows(df5,df6)%>%
arrange(TagID_hex,feeder,Date)
View(df7)
write.table(df7, file = "Masterdf_noRepeats.txt",sep="\t",row.names=FALSE)
df7$timeSincePreviousVisit <- as.numeric(as.character(df7$timeSincePreviousVisit))
hist(df7$timeSincePreviousVisit)
min(df7$timeSincePreviousVisit)
min(df7$timeSincePreviousVisit, na.rm = TRUE)
max(df7$timeSincePreviousVisit, na.rm = TRUE)
mean(df7$timeSincePreviousVisit, na.rm = TRUE)
median(df7$timeSincePreviousVisit, na.rm = TRUE)
#how many seconds in a day?
24*60*60
#daylight hours?
16*60*60
hist(df7$timeSincePreviousVisit)
15*60*60
mean(df7$timeSincePreviousVisit, na.rm = TRUE)
median(df7$timeSincePreviousVisit, na.rm = TRUE)
