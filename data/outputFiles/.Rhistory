library(tidyverse)
library(rmarkdown)
library(dplyr)
library(tidyr)
library(lubridate)
library(ggplot2)
setwd("F:/RWorkspace/GitHub/RFID-workshop/data/outputFiles")
df<-read.delim("Masterdf_noRepeats.txt", header=TRUE)
head(df)
names(df)
individualvisits<-df%>%
count(feeder, TagID_hex, date, sort = TRUE)
View(individualvisits)
plot(df$TagID_hex, df$date)
plot(individualvisits$TagID_hex, individualvisits$date)
plot(individualvisits$TagID_hex, individualvisits$date)
View(individualvisits)
View(individualvisits)
plot(individualvisits$TagID_hex, individualvisits$n)
View(individualvisits)
individualvisits$TagID_hex <- as.numeric(as.character(individualvisits$TagID_hex))
class(individualvisits$TagID_hex)
View(individualvisits)
individualvisits<-df%>%
count(feeder, TagID_hex, date, sort = TRUE)
individualvisits$TagID_hex <- as.character(individualvisits$TagID_hex)
class(individualvisits$TagID_hex)
plot(individualvisits$TagID_hex, individualvisits$n)
View(individualvisits)
unique(individualVisits$TagID_hex)
unique(individualvisits$TagID_hex)
rm(individualvisits)
individualVisits<-df%>%
count(feeder, TagID_hex, date, sort = TRUE)
plot(individualVisits$feeder, individualVisits$n)
df%>%
ggplot(aes(x = TagID_hex, y = n, color = feeder))
View(individualVisits)
df$n
names(individualVisits)
class(df$n)
names(df)[names(df) == "n"] <- "visits"
names(df)
individualVisits%>%
ggplot(aes(x = TagID_hex, y = n, color = feeder))
individualVisits%>%
ggplot(aes(x = TagID_hex, y = n, color = feeder))+
geom_smooth(method="lm", size = 1.5, se=FALSE) +
labs(x = "Bird ID", y = "total Visits") +
geom_point(aes(shape=treatmentOrder), size=3)
individualVisits%>%
ggplot(aes(x = TagID_hex, y = n, color = feeder))+
geom_smooth(method="lm", size = 1.5, se=FALSE) +
labs(x = "Bird ID", y = "total Visits") +
geom_point(aes(shape=feeder), size=3)
individualVisits%>%
ggplot(aes(x = TagID_hex, y = n, color = feeder))+
geom_smooth(method="lm", size = 1.5, se=FALSE) +
labs(x = "Bird ID", y = "total Visits") +
geom_point(aes(shape=feeder), size=3) +   geom_point(size=2) +
theme_bw() +   theme(axis.text.x = element_text(angle=90))
individualVisits%>%
ggplot(aes(x = TagID_hex, y = n, color = feeder))+
geom_smooth(method="lm", size = 1.5, se=FALSE) +
labs(x = "Bird ID", y = "total Visits") +
geom_point(aes(shape=feeder), size=3) +   geom_point(size=1) +
theme_bw() +   theme(axis.text.x = element_text(angle=90))
individualVisits%>%
ggplot(aes(x = TagID_hex, y = n, color = feeder))+
geom_smooth(method="lm", size = 1.5, se=FALSE) +
labs(x = "Bird ID", y = "total Visits") +
geom_point(aes(shape=feeder), size=1) +
theme_bw() +   theme(axis.text.x = element_text(angle=90))
individualVisits%>%
ggplot(aes(x = TagID_hex, y = n, color = feeder))+
geom_smooth(method="lm", size = 1.5, se=FALSE) +
labs(x = "Bird ID", y = "total Visits") +
geom_point(aes(shape=feeder), size=2) +
theme_bw() +   theme(axis.text.x = element_text(angle=90))
individualVisits%>%
ggplot(aes(x = TagID_hex, y = n, color = feeder))+  #specify axis labels and groupings
#geom_smooth(method="lm", size = 1.5, se=FALSE) +
labs(x = "Bird ID", y = "total Visits") +
geom_point(aes(shape=feeder), size=2) +
theme_bw() +   theme(axis.text.x = element_text(angle=90))
ProportionVisits<-individualvisits%>%
group_by(TagID_hex, date)%>%
arrange(TagID_hex)%>%
mutate(freq = visits / sum(visits))%>%
ungroup()
ProportionVisits<-individualVisits%>%
group_by(TagID_hex, date)%>%
arrange(TagID_hex)%>%
mutate(freq = visits / sum(visits))%>%
ungroup()
names(indiviudalVisits)
names(individualVisits)
names(individualVisits)[names(individualVisits) == "n"] <- "visits"  #rename columns
names(individualVisits)
individualVisits%>%
ggplot(aes(x = TagID_hex, y = visits, color = feeder))+  #specify axis labels and groupings
labs(x = "Bird ID", y = "Total visits") + #specify axis labels
geom_point(aes(shape=feeder), size=2) + # specify shape and size of points for the variable feeder
theme_bw() +   theme(axis.text.x = element_text(angle=90)) #removes the default gray background and rotates x labels.
individualVisits%>%
ggplot(aes(x = TagID_hex, y = visits, color = feeder))+  #specify axis labels and groupings
labs(x = "Bird ID", y = "Total visits") + #specify axis labels
geom_point(aes(shape=feeder), size=2) + # specify shape and size of points for the variable feeder
theme_bw() +   theme(axis.text.x = element_text(angle=90)) #removes the default gray background and rotates x labels.
+ ylim(0, 25)
individualVisits%>%
ggplot(aes(x = TagID_hex, y = visits, color = feeder))+  #specify axis labels and groupings
labs(x = "Bird ID", y = "Total visits") + #specify axis labels
geom_point(aes(shape=feeder), size=2, ylim(0,25)) + # specify shape and size of points for the variable feeder
theme_bw() +   theme(axis.text.x = element_text(angle=90))
individualVisits%>%
ggplot(aes(x = TagID_hex, y = visits, color = feeder))+  #specify axis labels and groupings
labs(x = "Bird ID", y = "Total visits") + #specify axis labels
geom_point(aes(shape=feeder), size=2) + # specify shape and size of points for the variable feeder
theme_bw() +   theme(axis.text.x = element_text(angle=90))+
geom_point() + #removes the default gray background and rotates x labels.
ylim(0, 25)
individualVisits%>%
ggplot(aes(x = TagID_hex, y = visits, color = feeder))+  #specify axis labels and groupings
labs(x = "Bird ID", y = "Total visits") + #specify axis labels
geom_point(aes(shape=feeder), size=2) + # specify shape and size of points for the variable feeder
theme_bw() +   theme(axis.text.x = element_text(angle=90))+
geom_point() + #removes the default gray background and rotates x labels.
ylim(0, 25) +
geom_point(position = position_jitter(width = 0.2))
individualVisits%>%
ggplot(aes(x = TagID_hex, y = visits, color = feeder))+  #specify axis labels and groupings
labs(x = "Bird ID", y = "Total visits") + #specify axis labels
geom_point(aes(shape=feeder), size=2) + # specify shape and size of points for the variable feeder
theme_bw() +   theme(axis.text.x = element_text(angle=90))+
geom_point() + #removes the default gray background and rotates x labels.
ylim(0, 25) +
geom_point(position = position_jitter(width = 0.3))
individualVisits%>%
ggplot(aes(x = TagID_hex, y = visits, color = feeder))+  #specify axis labels and groupings
labs(x = "Bird ID", y = "Total visits") + #specify axis labels
geom_point(size=2) + # specify shape and size of points for the variable feeder
theme_bw() +   theme(axis.text.x = element_text(angle=90))+
geom_point() + #removes the default gray background and rotates x labels.
ylim(0, 25) + #specify axis limits
geom_point(position = position_jitter(width = 0.3))
individualVisits%>%
ggplot(aes(x = TagID_hex, y = visits, color = feeder))+  #specify axis labels and groupings
labs(x = "Bird ID", y = "Total visits") + #specify axis labels
geom_point(size=1) + # specify size ONLY of points for the variable feeder
theme_bw() +   theme(axis.text.x = element_text(angle=90))+
geom_point() + #removes the default gray background and rotates x labels.
ylim(0, 25) + #specify axis limits
geom_point(position = position_jitter(width = 0.3))
ProportionVisits<-individualVisits%>%
group_by(TagID_hex, date)%>%
arrange(TagID_hex)%>%
mutate(freq = visits / sum(visits))%>%
ungroup()
View(ProportionVisits)
View(ProportionVisits)
ProportionVisits<-individualVisits%>%
group_by(TagID_hex, date)%>%
arrange(TagID_hex)%>%
mutate(proportion = visits / sum(visits))%>%
ungroup()
View(ProportionVisits)
ggplot(individualVisits,aes(x=factor(visits),fill=factor(feeder)))+  ###x and y variables
geom_bar(position="fill")+
geom_text(aes(label=..count..),stat='count',position=position_fill(vjust=0.5)) +
scale_x_discrete (labels = c("F01","F02","F03")) +
theme_bw() +   theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_rect(linetype = "solid", colour = "black", size=.8)) +
#scale_fill_manual("Feeder", values = c("1" = "gray49", "0" = "gray84"))+
theme(text=element_text(size=12,  family="serif"),
axis.ticks = element_line(colour = "black", size = .6)) +
labs(x = "Feeder") +
labs(y = "Proportion of visits")
ggplot(individualVisits,aes(x=factor(visits),fill=factor(feeder)))+  ###x and y variables
geom_bar(position="fill")+
geom_text(aes(label=..count..),stat='count',position=position_fill(vjust=0.5)) +
#scale_x_discrete (labels = c("F01","F02","F03")) +
theme_bw() +   theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_rect(linetype = "solid", colour = "black", size=.8)) +
#scale_fill_manual("Feeder", values = c("1" = "gray49", "0" = "gray84"))+
theme(text=element_text(size=12,  family="serif"),
axis.ticks = element_line(colour = "black", size = .6)) +
labs(x = "Feeder") +
labs(y = "Proportion of visits")
ggplot(individualVisits,aes(x=factor(visits),fill=factor(feeder)))+  ###x and y variables
geom_bar(position="fill")+
geom_text(aes(label=..count..),stat='count',position=position_fill(vjust=0.5)) +
#scale_x_discrete (labels = c("F01","F02","F03")) +
theme_bw() +   theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_rect(linetype = "solid", colour = "black", size=.8)) +
#scale_fill_manual("Feeder", values = c("1" = "gray49", "0" = "gray84"))+
theme(text=element_text(size=12,  family="serif"),
axis.ticks = element_line(colour = "black", size = .6)) +
# labs(x = "Feeder") +
labs(y = "Proportion of visits")
ggplot(individualVisits,aes(x=factor(TagID_hex),fill=factor(feeder)))+  ###x and y variables
geom_bar(position="fill")+
geom_text(aes(label=..count..),stat='count',position=position_fill(vjust=0.5)) +
#scale_x_discrete (labels = c("F01","F02","F03")) +
theme_bw() +   theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_rect(linetype = "solid", colour = "black", size=.8)) +
#scale_fill_manual("Feeder", values = c("1" = "gray49", "0" = "gray84"))+
theme(text=element_text(size=12,  family="serif"),
axis.ticks = element_line(colour = "black", size = .6)) +
# labs(x = "Feeder") +
labs(y = "Proportion of visits")
ggplot(individualVisits,aes(x=factor(TagID_hex),fill=factor(feeder)))+  ###x and y variables
geom_bar(position="fill")+
geom_text(aes(label=..count..),stat='count',position=position_fill(vjust=0.5)) +
#scale_x_discrete (labels = c("F01","F02","F03")) +
theme_bw() +   theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_rect(linetype = "solid", colour = "black", size=.8)) +
#scale_fill_manual("Feeder", values = c("1" = "gray49", "0" = "gray84"))+
theme(text=element_text(size=12,  family="serif"),
axis.ticks = element_line(colour = "black", size = .6)) +
labs(x = "Bird ID") +
labs(y = "Proportion of visits") +
theme_bw() +   theme(axis.text.x = element_text(angle=90))
unique(individualVisits$TagID_hex)
View(df)
View(individualVisits)
View(individualVisits)
View(df)
ggplot(df,aes(x=factor(TagID_hex),fill=factor(feeder)))+
geom_bar(position="fill")+
geom_text(aes(label=..count..),stat='count',position=position_fill(vjust=0.5)) +
#scale_x_discrete (labels = c("F01","F02","F03")) +
theme_bw() +   theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_rect(linetype = "solid", colour = "black", size=.8)) +
#scale_fill_manual("Feeder", values = c("1" = "gray49", "0" = "gray84"))+
theme(text=element_text(size=12,  family="serif"),
axis.ticks = element_line(colour = "black", size = .6)) +
labs(x = "Bird ID") +
labs(y = "Proportion of visits") +
theme_bw() +   theme(axis.text.x = element_text(angle=90))
ggplot(df,aes(x=factor(TagID_hex),fill=factor(feeder)))+
geom_bar(position="fill")+
geom_text(aes(label=..count..),stat='count',position=position_fill(vjust=0.5), angle=90) +
#scale_x_discrete (labels = c("F01","F02","F03")) +
theme_bw() +   theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_rect(linetype = "solid", colour = "black", size=.8)) +
#scale_fill_manual("Feeder", values = c("1" = "gray49", "0" = "gray84"))+
theme(text=element_text(size=12,  family="serif"),
axis.ticks = element_line(colour = "black", size = .6)) +
labs(x = "Bird ID") +
labs(y = "Proportion of visits") +
theme_bw() +   theme(axis.text.x = element_text(angle=90))
ggplot(df,aes(x=factor(TagID_hex),fill=factor(feeder)))+
geom_bar(position="fill")+
geom_text(aes(label=..count..),stat='count',position=position_fill(vjust=0.5), angle=90, size=1) +
#scale_x_discrete (labels = c("F01","F02","F03")) +
theme_bw() +   theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_rect(linetype = "solid", colour = "black", size=.8)) +
#scale_fill_manual("Feeder", values = c("1" = "gray49", "0" = "gray84"))+
theme(text=element_text(size=12,  family="serif"),
axis.ticks = element_line(colour = "black", size = .6)) +
labs(x = "Bird ID") +
labs(y = "Proportion of visits") +
theme_bw() +   theme(axis.text.x = element_text(angle=90))
ggplot(df,aes(x=factor(TagID_hex),fill=factor(feeder)))+
geom_bar(position="fill")+
geom_text(aes(label=..count..),stat='count',position=position_fill(vjust=0.5), angle=90, size=3) +
#scale_x_discrete (labels = c("F01","F02","F03")) +
theme_bw() +   theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
panel.border = element_rect(linetype = "solid", colour = "black", size=.8)) +
#scale_fill_manual("Feeder", values = c("1" = "gray49", "0" = "gray84"))+
theme(text=element_text(size=12,  family="serif"),
axis.ticks = element_line(colour = "black", size = .6)) +
labs(x = "Bird ID") +
labs(y = "Proportion of visits") +
theme_bw() +   theme(axis.text.x = element_text(angle=90))
